{{- define "chart.labels"  }}
  labels:
    date: {{ now | htmlDate }}
    version: {{ .Values.app.version }}
{{- end}}

apiVersion: v1
kind: ConfigMap
metadata:
  name: demo-config
  {{- template "chart.labels" . }}
data:
  name: {{ .Values.app.version | upper | quote }}
  {{- if eq .Values.env "production"}}
  paymentToken: "1234"
  {{- else }}
  paymentToken: false
  {{- end }}
  {{- with .Values.value.requirements.limits }}
  memory: {{ .memory }}
  cpu: {{ .cpu }}
  version: {{ $.Release.Name }}
  {{- end }}
  {{- $map := .Release.Name | upper | quote }}
  map: {{ $map }}
  users: |-
    {{- range tuple "Anton" "Vasia" }}
    - {{ . }}
    {{- end }}